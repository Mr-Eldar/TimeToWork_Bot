import asyncio
import datetime

from aiogram import Router, F
from aiogram.types import Message, CallbackQuery
from aiogram.filters import CommandStart, Command

# from app.database.requests import set_user
# from middlewares import BaseMiddleware

user = Router()

DAYS_PLAN = {
    0: {
        "morning": "üåÖ <b>–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ</b>\n\n"
                   "–í –¥–æ—Ä–æ–≥–µ —Å–µ–≥–æ–¥–Ω—è:\n"
                   "<b>–†—É—Å—Å–∫–∏–π —è–∑—ã–∫</b>\n"
                   "‚ñ∏ <b>—É–¥–∞—Ä–µ–Ω–∏—è, –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è</b> - ‚è± 10‚Äì15 –º–∏–Ω—É—Ç\n\n"
                   "–ü—Ä–æ—Å—Ç–æ –ø–æ—Å–º–æ—Ç—Ä–∏, –±–µ–∑ –Ω–∞–ø—Ä—è–≥–∞ üëç",
        "afternoon": "üåô <b>–ü–ª–∞–Ω –Ω–∞ –≤–µ—á–µ—Ä</b>\n\n"
                     "–†—É—Å—Å–∫–∏–π —è–∑—ã–∫\n"
                     "‚ñ∏ –æ—Ä—Ñ–æ–≥—Ä–∞—Ñ–∏—è\n"
                     "‚ñ∏ <b>5‚Äì7 –∑–∞–¥–∞–Ω–∏–π - ‚è± 40‚Äì60 –º–∏–Ω—É—Ç</b>\n\n"
                     "–≠—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ ‚úÖ",
    },
    1: {
         "morning": "üåÖ <b>–£—Ç—Ä–æ</b>\n\n"
                   "–°–µ–≥–æ–¥–Ω—è –≤ –¥–æ—Ä–æ–≥–µ:\n"
                   "<b>–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞</b>\n"
                   "‚ñ∏ <b>—Ç–µ–æ—Ä–∏—è, –ª–æ–≥–∏–∫–∞, –∞–ª–≥–æ—Ä–∏—Ç–º—ã</b> - ‚è± 10‚Äì15 –º–∏–Ω—É—Ç\n\n"
                   "–ë–µ–∑ –∑–∞–¥–∞—á, –ø—Ä–æ—Å—Ç–æ –ø–æ–Ω—è—Ç—å üß†",
        "afternoon": "üåô <b>–°–µ–≥–æ–¥–Ω—è –≤–µ—á–µ—Ä–æ–º</b>\n\n"
                     "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ (–û–ì–≠)\n"
                     "‚ñ∏ 5‚Äì8 –∑–∞–¥–∞–Ω–∏–π\n"
                     "‚ñ∏ –±–µ–∑ —Å–ø–µ—à–∫–∏\n\n"
                     "–ì–ª–∞–≤–Ω–æ–µ ‚Äî –ø–æ–Ω—è—Ç—å –æ—à–∏–±–∫–∏ üß†",
    },
    2: {
        "morning": "üåÖ <b>–£—Ç—Ä–æ</b>\n\n"
                   "–í –¥–æ—Ä–æ–≥–µ:\n"
                   "<b>–û–±—â–µ—Å—Ç–≤–æ–∑–Ω–∞–Ω–∏–µ</b>\n"
                   "‚ñ∏ <b>—Ç–µ—Ä–º–∏–Ω—ã –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</b> - 10‚Äì15 –º–∏–Ω—É—Ç ‚Äî –∏ –≥–æ—Ç–æ–≤–æ ‚úÖ\n\n",
        "afternoon": "üåô <b>–ü–ª–∞–Ω –ø—Ä–æ—Å—Ç–æ–π</b>\n\n"
                     "–û–±—â–µ—Å—Ç–≤–æ–∑–Ω–∞–Ω–∏–µ\n"
                     "‚ñ∏ —Ç–µ—Ä–º–∏–Ω—ã\n"
                     "‚ñ∏ <b>1 —Ç–µ–º–∞ - ‚è± ~40 –º–∏–Ω—É—Ç</b>\n\n"
                     "–ü–æ—Ç–æ–º –æ—Ç–¥—ã—Ö üëç",
    },
    3: {
        "morning": "üåÖ <b>–£—Ç—Ä–æ</b>\n\n"
                   "–°–µ–≥–æ–¥–Ω—è:\n"
                   "<b>–†—É—Å—Å–∫–∏–π —è–∑—ã–∫</b>\n"
                   "‚ñ∏ <b>–ø—Ä–∞–≤–∏–ª–∞ + –ø—Ä–∏–º–µ—Ä—ã</b> - ‚è± 10‚Äì15 –º–∏–Ω—É—Ç\n\n"
                   "–õ—ë–≥–∫–∏–π —Å—Ç–∞—Ä—Ç –¥–Ω—è üëç",
        "afternoon": "üåô <b>–í–µ—á–µ—Ä</b>\n\n"
                     "–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞\n"
                     "‚ñ∏ 5‚Äì7 –∑–∞–¥–∞–Ω–∏–π\n"
                     "–ò–õ–ò\n"
                     "‚ñ∏ —Ç–µ–æ—Ä–∏—è + 2 –∑–∞–¥–∞—á–∏\n\n"
                     "–í—ã–±–∏—Ä–∞–π —Å–∞–º üí™",
    },
    4: {
        "morning": "üåÖ <b>–ü—è—Ç–Ω–∏—Ü–∞ üòå</b>\n\n"
                   "–°–µ–≥–æ–¥–Ω—è –≤ –¥–æ—Ä–æ–≥–µ:\n"
                   "<b>–õ—ë–≥–∫–∏–π –ø–æ–≤—Ç–æ—Ä</b>\n"
                   "‚ñ∏ <b>‚ñ∏ —á—Ç–æ –∑–∞–ø–æ–º–Ω–∏–ª–æ—Å—å –∑–∞ –Ω–µ–¥–µ–ª—é</b> - ‚è± 10‚Äì15 –º–∏–Ω—É—Ç\n\n"
                   "–ë–µ–∑ –¥–∞–≤–ª–µ–Ω–∏—è.",
        "afternoon": "üåô <b>–ü—è—Ç–Ω–∏—Ü–∞</b>\n\n"
                     "–°–µ–≥–æ–¥–Ω—è\n"
                     "üíª –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ\n"
                     "–ò–õ–ò\n"
                     "üò¥ –æ—Ç–¥—ã—Ö",
    },
    5: {
        "morning": "üåÖ <b>–°—É–±–±–æ—Ç–∞</b>\n\n"
                   "–°–µ–≥–æ–¥–Ω—è –¥–æ–ø—ã –ø–æ –æ–±—â–µ—Å—Ç–≤—É\n"
                   "<b>–ü—Ä–æ—Å—Ç–æ –Ω–∞—Å—Ç—Ä–æ–π—Å—è, –±–µ–∑ —É—á—ë–±—ã —Å–µ–π—á–∞—Å üëç</b>\n",
        "afternoon": "üåô <b>–ü–æ—Å–ª–µ –¥–æ–ø–æ–≤</b>\n\n"
                     "–°–µ–≥–æ–¥–Ω—è –º–æ–∂–Ω–æ:\n"
                         "üíª –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ\n"
                     "–ò–õ–ò\n"
                     "‚ñ∏ –∏–ª–∏ —Ä–∞–∑–æ–±—Ä–∞—Ç—å –æ—à–∏–±–∫–∏\n"
                     "‚è± <b>–¥–æ 1 —á–∞—Å–∞</b>",
    },
    6: {
        "morning": "üåÖ <b>–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ</b>\n\n"
                   "–°–µ–≥–æ–¥–Ω—è –±–µ–∑ —à–∫–æ–ª—ã\n"
                   "<b>–ü–æ–∑–∂–µ –±—É–¥–µ—Ç —Å–ø–æ–∫–æ–π–Ω—ã–π –ø–æ–≤—Ç–æ—Ä ‚úåÔ∏è</b>\n",
        "afternoon": "üåô <b>–°–ø–æ–∫–æ–π–Ω—ã–π –≤–µ—á–µ—Ä</b>\n\n"
                     "‚ñ∏ –ª—ë–≥–∫–∏–π –ø–æ–≤—Ç–æ—Ä\n"
                     "‚ñ∏ –∏–ª–∏ –ø–æ–ª–Ω—ã–π –æ—Ç–¥—ã—Ö\n"
                     "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ ‚Äî —ç—Ç–æ –º–∞—Ä–∞—Ñ–æ–Ω üèÉ‚Äç‚ôÇÔ∏è"
    }
}


async def check_time_notification(message: Message):
    sent_morning = False
    sent_evening = False

    while True:
        time = datetime.datetime.now()
        day = datetime.datetime.today().weekday()

        if time.hour == 7 and time.minute == 30 and not sent_morning:
            sent_morning = True

            await message.bot.send_message(
                chat_id=message.chat.id,
                text=f'{DAYS_PLAN[day]["morning"]}'
            )

            await asyncio.sleep(61)
        elif time.hour == 20 and time.minute == 00 and not sent_evening:
            sent_evening = True

            await message.bot.send_message(
                    chat_id=message.chat.id,
                    text=f'{DAYS_PLAN[day]["afternoon"]}'
                )

            await asyncio.sleep(61)
        elif time.hour == 00 and time.minute == 00:
            sent_morning = False
            sent_evening = False
        else:
            await asyncio.sleep(60)


@user.message(CommandStart())
async def cmd_start(message: Message):
    print('–ó–∞–ø—É—Å–∫')
    await message.answer('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –±–æ—Ç!')
    await asyncio.create_task(check_time_notification(message))
